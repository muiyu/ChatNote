# 处理器优化

- 五阶段处理器
    1. 取指
    2. 译码
    3. 执行
    4. 访存
    5. 写回
- 流水线执行
    1. 指令流水线
    2. 前端与后端
        1. 前端：加载+解码
        2. 后端：执行+……
    3. 性能评价
        1. CPI：每指令平均时钟周期数
        2. IPC：每时钟周期的平均指令数
    4. 各个阶段执行很难在1个时钟周期内完成 
        1. 细分：简化各个阶段的任务，进一步细分阶段
            1. 提高指令级并行度
            2. 有助于提高时钟频率
        2. 停顿
        3. 冒险
- 超标量处理
    - 使用多个执行单元，可以同时执行多条（同类型/不同类型）的指令
    - 为了适应超标量处理，会将机器指令拆解为微操作
    - CISC vs RISC
- 乱序执行
    
    <aside>
    💡
    
    借助乱序执行改造指令流水线，缓解数据冒险造成的流水线停顿
    
    </aside>
    
    1. 真依赖 → 旁路/乱序执行
        1. 旁路：直接从前一条指令的中间阶段将数据传递给下一条指令
        2. 乱序执行：在有多个执行单元的前提下，相对于顺序执行，在满足数据依赖的条件下，打乱指令执行的顺序，立刻进入执行阶段。
    2. 假依赖
        1. 寄存器重命名：使用一组额外的物理寄存器，将可能的依赖转化为不依赖，确保不同指令之间不会发生冲突。
- 推测执行
    - 应对条件分支的跳转，推测选择一条分支提前执行，若预测失败会使整个指令流水线停顿，造成较大的性能损失
    - 分支预测器（95%）
        - 基于饱和计数器或双模态预测器
        - 使用历史数据